#! /usr/bin/env python
'''
Testing suite for timeclock.py
'''

import time
from random import random
import sqlite3

def strTimeProp(start, end, prop, fmt="%H:%M:%S"):
    stime = time.mktime(time.strptime(start, fmt))
    etime = time.mktime(time.strptime(end, fmt))
    ptime = stime + prop * (etime - stime)
    return time.strftime(fmt, time.localtime(ptime))

def genRandRecord(date):
    cin = strTimeProp("08:15:00", "09:00:00", random())
    lout = strTimeProp("12:00:00", "13:00:00", random())
    cin = strTimeProp("13:00:00", "13:30:00", random())
    cout = strTimeProp("17:30:00", "18:00:00", random())
    return (date, cin, lout, lin, cout)

dates_in_april = ['2014-04-01',
                  '2014-04-02',
                  '2014-04-03',
                  '2014-04-04',
                  '2014-04-07',
                  '2014-04-08',
                  '2014-04-09',
                  '2014-04-10',
                  '2014-04-11',
                  '2014-04-14',
                  '2014-04-15',
                  '2014-04-16',
                  '2014-04-17',
                  '2014-04-18',
                  '2014-04-21',
                  '2014-04-22',
                  '2014-04-23',
                  '2014-04-24',
                  '2014-04-25',
                  '2014-04-28',
                  '2014-04-29',
                  '2014-04-30']

with sqlite3.connect('../../data/timeclock_test.db') as conn:
#    new_records= [('2014-03-03', '08:37:00', '13:01:00', '13:47:00', '17:30:00'),
#                  ('2014-03-04', '08:41:00', '13:05:00', '13:41:00', '17:31:00'),
#                  ('2014-03-05', '08:29:00', '13:02:00', '13:45:00', '17:32:00'),
#                  ('2014-03-06', '08:15:00', '13:00:00', '13:51:00', '17:37:00'),
#                  ('2014-03-07', '08:31:00', '13:06:00', '13:35:00', '17:33:00'),
#                  ('2014-03-10', '08:30:00', '13:07:00', '13:52:00', '17:45:00'),
#                  ('2014-03-11', '08:35:00', '13:00:00', '13:39:00', '17:33:00'),
#                  ('2014-03-12', '08:45:00', '13:01:00', '13:47:00', '17:30:00'),
#                  ('2014-03-13', '08:31:00', '13:03:00', '13:41:00', '17:41:00'),
#                  ('2014-03-14', '08:24:00', '12:34:00', '13:22:00', '17:37:00'),
#                  ('2014-03-17', '08:17:00', '12:01:00', '12:47:00', '18:00:00'),
#                  ('2014-03-18', '08:00:00', '12:41:00', '13:15:00', '17:32:00'),
#                  ('2014-03-19', '08:33:00', '12:45:00', '13:25:00', '17:00:00'),
#                  ('2014-03-20', '08:38:00', '13:03:00', '13:47:00', '17:33:00'),
#                  ('2014-03-21', '08:42:00', '13:00:00', '13:48:00', '17:31:00'),
#                  ('2014-03-24', '08:45:00', '13:05:00', '13:55:00', '17:30:00'),
#                  ('2014-03-25', '08:31:00', '13:01:00', '13:59:00', '17:30:00'),
#                  ('2014-03-26', '08:29:00', '12:00:00', '12:45:00', '17:36:00'),
#                  ('2014-03-27', '08:26:00', '13:01:00', '13:41:00', '17:38:00'),
#                  ('2014-03-28', '08:33:00', '13:02:00', '13:37:00', '17:51:00'),
#                  ('2014-03-31', '08:38:00', '12:50:00', '13:27:00', '17:40:00')]
    
#    conn.execute('''
#                 CREATE TABLE times (
#                 date TEXT,
#                 clockin TEXT,
#                 lunchout TEXT,
#                 lunchin TEXT,
#                 clockout TEXT);
#                 '''
#                )
    
#    conn.executemany('''INSERT INTO times
#                        (date, clockin, lunchout, lunchin, clockout)
#                        VALUES (?,?,?,?,?)''', new_records)

    for date in dates_in_april:
        conn.execute('''
                     INSERT INTO times
                     VALUES (?,?,?,?,?)
                     ''', genRandRecord(date)
                    )

    conn.commit()
    conn.close()
